{"ast":null,"code":"import _objectSpread from\"C:/Users/MARCE/source/repos/CrazyPuzzle/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{realtimeDb}from'./firebase';import{ref,push,onValue,set,get,remove}from'firebase/database';import DifficultySelector from'./DifficultySelector';import MultiplayerLeaderboard from'./MultiplayerLeaderboard';import styles from'./MultiplayerLobby.module.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function MultiplayerLobby(_ref){let{user,onJoinRoom,onBackToSinglePlayer}=_ref;const[rooms,setRooms]=useState([]);const[difficulty,setDifficulty]=useState('easy');const[layout,setLayout]=useState('grid');const[showCreateModal,setShowCreateModal]=useState(false);const[pendingRoomIds,setPendingRoomIds]=useState(new Set());// Player limits based on difficulty\nconst getMaxPlayers=diff=>{const limits={easy:2,medium:3,hard:4};return limits[diff];};useEffect(()=>{const roomsRef=ref(realtimeDb,'rooms');// Add error listener\nconst unsubscribe=onValue(roomsRef,snapshot=>{const data=snapshot.val();if(data){const allRooms=Object.entries(data).map(_ref2=>{let[id,room]=_ref2;return _objectSpread({id},room);});const waitingRooms=allRooms.filter(room=>room.status==='waiting');setRooms(waitingRooms);// Check if the current user has been accepted into any room they were pending for\nfor(const roomId of Array.from(pendingRoomIds)){const room=data[roomId];if(room&&room.players&&room.players[user.uid]){// User was accepted into the room\nsetPendingRoomIds(prev=>{const next=new Set(prev);next.delete(roomId);return next;});// Navigate to the game\nonJoinRoom(roomId,room.difficulty,room.layout);return;// Stop checking other rooms\n}}}else{setRooms([]);}},error=>{});return()=>unsubscribe();},[user.uid,onJoinRoom,pendingRoomIds]);const createRoom=async()=>{try{const roomsRef=ref(realtimeDb,'rooms');const newRoomRef=push(roomsRef);const room={hostId:user.uid,hostName:user.displayName||'Anonymous',difficulty,layout,players:{[user.uid]:{name:user.displayName||'Anonymous',ready:false}},status:'waiting',createdAt:Date.now()};await set(newRoomRef,room);setShowCreateModal(false);onJoinRoom(newRoomRef.key,difficulty,layout);}catch(error){console.error('Full error:',JSON.stringify(error,null,2));const errorMsg=error.code==='PERMISSION_DENIED'?'Permission denied. Your Firebase Realtime Database security rules may have expired. Please update them in the Firebase Console.':\"Failed to create room: \".concat(error.message);alert(errorMsg);}};const joinRoom=async(roomId,roomDifficulty,roomLayout)=>{const roomRef=ref(realtimeDb,\"rooms/\".concat(roomId));const snapshot=await get(roomRef);if(snapshot.exists()){const room=snapshot.val();const playerCount=Object.keys(room.players||{}).length;const pendingCount=Object.keys(room.pendingPlayers||{}).length;const maxPlayers=getMaxPlayers(roomDifficulty);if(playerCount+pendingCount<maxPlayers){// Send join request to pending instead of directly joining\nawait set(ref(realtimeDb,\"rooms/\".concat(roomId,\"/pendingPlayers/\").concat(user.uid)),{name:user.displayName||'Anonymous'});// Track that we're waiting for approval for this room\nsetPendingRoomIds(prev=>new Set(prev).add(roomId));alert('Join request sent! Waiting for host approval...');}else{alert('Room is full!');}}};const deleteRoom=async(roomId,roomName)=>{if(window.confirm(\"Are you sure you want to delete \\\"\".concat(roomName,\"\\\"?\"))){try{await remove(ref(realtimeDb,\"rooms/\".concat(roomId)));}catch(error){alert('Failed to delete room');}}};const deleteOldRooms=async()=>{// Only run cleanup if user has created rooms before\n// This prevents permission errors for users just viewing the lobby\ntry{const roomsRef=ref(realtimeDb,'rooms');const snapshot=await get(roomsRef);if(snapshot&&snapshot.exists()){const data=snapshot.val();const now=Date.now();const thirtyMinutes=30*60*1000;// Only delete rooms created by current user\nconst userRooms=Object.entries(data).filter(_ref3=>{let[id,room]=_ref3;return room.hostId===user.uid&&now-room.createdAt>thirtyMinutes;});if(userRooms.length>0){for(const[id]of userRooms){try{await remove(ref(realtimeDb,\"rooms/\".concat(id)));}catch(deleteError){// Skip rooms we can't delete\n}}}}}catch(error){// Silently fail - this is not critical functionality\n// Most likely a permission error for users who haven't created rooms\n}};useEffect(()=>{// Only attempt cleanup, don't wait for it\ndeleteOldRooms().catch(()=>{});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsxs(\"div\",{className:styles.lobbyContainer,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.lobbyHeader,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83C\\uDFAE Multiplayer Lobby\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onBackToSinglePlayer,className:styles.backBtn,children:\"\\u2190 Back to Menu\"})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.lobbyActions,children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCreateModal(true);},className:styles.createRoomBtn,children:\"+ Create Room\"})}),showCreateModal&&/*#__PURE__*/_jsx(\"div\",{className:styles.modal,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.modalContent,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Room\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.formGroup,children:/*#__PURE__*/_jsx(DifficultySelector,{difficulty:difficulty,layout:layout,onDifficultyChange:setDifficulty,onLayoutChange:setLayout,showLayout:true,showMaxPlayers:true})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.modalActions,children:[/*#__PURE__*/_jsx(\"button\",{onClick:createRoom,className:styles.confirmBtn,children:\"Create\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreateModal(false),className:styles.cancelBtn,children:\"Cancel\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.roomsList,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Available Rooms\"}),rooms.length===0?/*#__PURE__*/_jsx(\"p\",{className:styles.noRooms,children:\"No rooms available. Create one to start!\"}):/*#__PURE__*/_jsx(\"div\",{className:styles.roomsGrid,children:rooms.map(room=>{var _room$layout;const playerCount=Object.keys(room.players||{}).length;const maxPlayers=getMaxPlayers(room.difficulty);const isFull=playerCount>=maxPlayers;const isHost=room.hostId===user.uid;return/*#__PURE__*/_jsxs(\"div\",{className:styles.roomCard,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.roomHeader,children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Room by \",room.hostName]}),/*#__PURE__*/_jsx(\"span\",{className:styles.difficultyBadge,children:room.difficulty})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.roomInfo,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDC65 Players: \",playerCount,\"/\",maxPlayers]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u23F1\\uFE0F Difficulty: \",room.difficulty.toUpperCase()]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83C\\uDFA8 Layout: \",((_room$layout=room.layout)===null||_room$layout===void 0?void 0:_room$layout.toUpperCase())||'GRID']})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.roomActions,children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>joinRoom(room.id,room.difficulty,room.layout||'grid'),className:styles.joinBtn,disabled:isFull,children:isFull?'Full':'Join Room'}),isHost&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteRoom(room.id,\"Room by \".concat(room.hostName)),className:styles.deleteBtn,title:\"Delete this room\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]},room.id);})})]}),/*#__PURE__*/_jsx(MultiplayerLeaderboard,{})]});}export default MultiplayerLobby;","map":{"version":3,"names":["React","useState","useEffect","realtimeDb","ref","push","onValue","set","get","remove","DifficultySelector","MultiplayerLeaderboard","styles","jsx","_jsx","jsxs","_jsxs","MultiplayerLobby","_ref","user","onJoinRoom","onBackToSinglePlayer","rooms","setRooms","difficulty","setDifficulty","layout","setLayout","showCreateModal","setShowCreateModal","pendingRoomIds","setPendingRoomIds","Set","getMaxPlayers","diff","limits","easy","medium","hard","roomsRef","unsubscribe","snapshot","data","val","allRooms","Object","entries","map","_ref2","id","room","_objectSpread","waitingRooms","filter","status","roomId","Array","from","players","uid","prev","next","delete","error","createRoom","newRoomRef","hostId","hostName","displayName","name","ready","createdAt","Date","now","key","console","JSON","stringify","errorMsg","code","concat","message","alert","joinRoom","roomDifficulty","roomLayout","roomRef","exists","playerCount","keys","length","pendingCount","pendingPlayers","maxPlayers","add","deleteRoom","roomName","window","confirm","deleteOldRooms","thirtyMinutes","userRooms","_ref3","deleteError","catch","className","lobbyContainer","children","lobbyHeader","onClick","backBtn","lobbyActions","createRoomBtn","modal","modalContent","formGroup","onDifficultyChange","onLayoutChange","showLayout","showMaxPlayers","modalActions","confirmBtn","cancelBtn","roomsList","noRooms","roomsGrid","_room$layout","isFull","isHost","roomCard","roomHeader","difficultyBadge","roomInfo","toUpperCase","roomActions","joinBtn","disabled","deleteBtn","title"],"sources":["C:/Users/MARCE/source/repos/CrazyPuzzle/web/src/MultiplayerLobby.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { User } from 'firebase/auth';\r\nimport { realtimeDb } from './firebase';\r\nimport { ref, push, onValue, set, get, remove } from 'firebase/database';\r\nimport DifficultySelector, { Difficulty, Layout } from './DifficultySelector';\r\nimport MultiplayerLeaderboard from './MultiplayerLeaderboard';\r\nimport styles from './MultiplayerLobby.module.scss';\r\n\r\ninterface Room {\r\n  id: string;\r\n  hostId: string;\r\n  hostName: string;\r\n  difficulty: Difficulty;\r\n  layout: Layout;\r\n  players: { [key: string]: { name: string; ready: boolean } };\r\n  status: 'waiting' | 'playing' | 'finished';\r\n  createdAt: number;\r\n}\r\n\r\ninterface MultiplayerLobbyProps {\r\n  user: User;\r\n  onJoinRoom: (roomId: string, difficulty: Difficulty, layout: Layout) => void;\r\n  onBackToSinglePlayer: () => void;\r\n}\r\n\r\nfunction MultiplayerLobby({ user, onJoinRoom, onBackToSinglePlayer }: MultiplayerLobbyProps) {\r\n  const [rooms, setRooms] = useState<Room[]>([]);\r\n  const [difficulty, setDifficulty] = useState<Difficulty>('easy');\r\n  const [layout, setLayout] = useState<Layout>('grid');\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [pendingRoomIds, setPendingRoomIds] = useState<Set<string>>(new Set());\r\n\r\n  // Player limits based on difficulty\r\n  const getMaxPlayers = (diff: Difficulty): number => {\r\n    const limits = { easy: 2, medium: 3, hard: 4 };\r\n    return limits[diff];\r\n  };\r\n\r\n  useEffect(() => {\r\n    const roomsRef = ref(realtimeDb, 'rooms');\r\n    \r\n    // Add error listener\r\n    const unsubscribe = onValue(roomsRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      \r\n      if (data) {\r\n        const allRooms = Object.entries(data).map(([id, room]: [string, any]) => ({\r\n          id,\r\n          ...room\r\n        }));\r\n        \r\n        const waitingRooms = allRooms.filter(room => room.status === 'waiting');\r\n        \r\n        setRooms(waitingRooms);\r\n\r\n        // Check if the current user has been accepted into any room they were pending for\r\n        for (const roomId of Array.from(pendingRoomIds)) {\r\n          const room = data[roomId];\r\n          if (room && room.players && room.players[user.uid]) {\r\n            // User was accepted into the room\r\n            setPendingRoomIds(prev => {\r\n              const next = new Set(prev);\r\n              next.delete(roomId);\r\n              return next;\r\n            });\r\n            // Navigate to the game\r\n            onJoinRoom(roomId, room.difficulty, room.layout);\r\n            return; // Stop checking other rooms\r\n          }\r\n        }\r\n      } else {\r\n        setRooms([]);\r\n      }\r\n    }, (error: any) => {\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [user.uid, onJoinRoom, pendingRoomIds]);\r\n\r\n  const createRoom = async () => {\r\n    try {\r\n      \r\n      const roomsRef = ref(realtimeDb, 'rooms');\r\n      \r\n      const newRoomRef = push(roomsRef);\r\n      \r\n      const room = {\r\n        hostId: user.uid,\r\n        hostName: user.displayName || 'Anonymous',\r\n        difficulty,\r\n        layout,\r\n        players: {\r\n          [user.uid]: {\r\n            name: user.displayName || 'Anonymous',\r\n            ready: false\r\n          }\r\n        },\r\n        status: 'waiting',\r\n        createdAt: Date.now()\r\n      };\r\n      await set(newRoomRef, room);\r\n      setShowCreateModal(false);\r\n      onJoinRoom(newRoomRef.key!, difficulty, layout);\r\n    } catch (error: any) {\r\n      console.error('Full error:', JSON.stringify(error, null, 2));\r\n      \r\n      const errorMsg = error.code === 'PERMISSION_DENIED' \r\n        ? 'Permission denied. Your Firebase Realtime Database security rules may have expired. Please update them in the Firebase Console.'\r\n        : `Failed to create room: ${error.message}`;\r\n      \r\n      alert(errorMsg);\r\n    }\r\n  };\r\n\r\n  const joinRoom = async (roomId: string, roomDifficulty: Difficulty, roomLayout: Layout) => {\r\n    const roomRef = ref(realtimeDb, `rooms/${roomId}`);\r\n    const snapshot = await get(roomRef);\r\n    \r\n    if (snapshot.exists()) {\r\n      const room = snapshot.val();\r\n      const playerCount = Object.keys(room.players || {}).length;\r\n      const pendingCount = Object.keys(room.pendingPlayers || {}).length;\r\n      const maxPlayers = getMaxPlayers(roomDifficulty);\r\n      \r\n      if (playerCount + pendingCount < maxPlayers) {\r\n        // Send join request to pending instead of directly joining\r\n        await set(ref(realtimeDb, `rooms/${roomId}/pendingPlayers/${user.uid}`), {\r\n          name: user.displayName || 'Anonymous'\r\n        });\r\n        // Track that we're waiting for approval for this room\r\n        setPendingRoomIds(prev => new Set(prev).add(roomId));\r\n        alert('Join request sent! Waiting for host approval...');\r\n      } else {\r\n        alert('Room is full!');\r\n      }\r\n    }\r\n  };\r\n\r\n  const deleteRoom = async (roomId: string, roomName: string) => {\r\n    if (window.confirm(`Are you sure you want to delete \"${roomName}\"?`)) {\r\n      try {\r\n        await remove(ref(realtimeDb, `rooms/${roomId}`));\r\n      } catch (error) {\r\n        alert('Failed to delete room');\r\n      }\r\n    }\r\n  };\r\n\r\n  const deleteOldRooms = async () => {\r\n    // Only run cleanup if user has created rooms before\r\n    // This prevents permission errors for users just viewing the lobby\r\n    try {\r\n      const roomsRef = ref(realtimeDb, 'rooms');\r\n      const snapshot = await get(roomsRef);\r\n      \r\n      if (snapshot && snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        const now = Date.now();\r\n        const thirtyMinutes = 30 * 60 * 1000;\r\n      \r\n        // Only delete rooms created by current user\r\n        const userRooms = Object.entries(data).filter(([id, room]: [string, any]) => \r\n          room.hostId === user.uid && now - room.createdAt > thirtyMinutes\r\n        );\r\n\r\n        if (userRooms.length > 0) {\r\n          for (const [id] of userRooms) {\r\n            try {\r\n              await remove(ref(realtimeDb, `rooms/${id}`));\r\n            } catch (deleteError) {\r\n              // Skip rooms we can't delete\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // Silently fail - this is not critical functionality\r\n      // Most likely a permission error for users who haven't created rooms\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Only attempt cleanup, don't wait for it\r\n    deleteOldRooms().catch(() => {});\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <div className={styles.lobbyContainer}>\r\n      <div className={styles.lobbyHeader}>\r\n        <h1>üéÆ Multiplayer Lobby</h1>\r\n        <button onClick={onBackToSinglePlayer} className={styles.backBtn}>\r\n          ‚Üê Back to Menu\r\n        </button>\r\n      </div>\r\n\r\n      <div className={styles.lobbyActions}>\r\n        <button \r\n          onClick={() => {\r\n            setShowCreateModal(true);\r\n          }} \r\n          className={styles.createRoomBtn}\r\n        >\r\n          + Create Room\r\n        </button>\r\n      </div>\r\n\r\n      {showCreateModal && (\r\n        <div className={styles.modal}>\r\n          <div className={styles.modalContent}>\r\n            <h2>Create New Room</h2>\r\n            <div className={styles.formGroup}>\r\n              <DifficultySelector \r\n                difficulty={difficulty}\r\n                layout={layout}\r\n                onDifficultyChange={setDifficulty}\r\n                onLayoutChange={setLayout}\r\n                showLayout={true}\r\n                showMaxPlayers={true}\r\n              />\r\n            </div>\r\n            <div className={styles.modalActions}>\r\n              <button onClick={createRoom} className={styles.confirmBtn}>Create</button>\r\n              <button onClick={() => setShowCreateModal(false)} className={styles.cancelBtn}>Cancel</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className={styles.roomsList}>\r\n        <h2>Available Rooms</h2>\r\n        {rooms.length === 0 ? (\r\n          <p className={styles.noRooms}>No rooms available. Create one to start!</p>\r\n        ) : (\r\n          <div className={styles.roomsGrid}>\r\n            {rooms.map(room => {\r\n              const playerCount = Object.keys(room.players || {}).length;\r\n              const maxPlayers = getMaxPlayers(room.difficulty);\r\n              const isFull = playerCount >= maxPlayers;\r\n              const isHost = room.hostId === user.uid;\r\n              \r\n              return (\r\n                <div key={room.id} className={styles.roomCard}>\r\n                  <div className={styles.roomHeader}>\r\n                    <h3>Room by {room.hostName}</h3>\r\n                    <span className={styles.difficultyBadge}>{room.difficulty}</span>\r\n                  </div>\r\n                  <div className={styles.roomInfo}>\r\n                    <p>üë• Players: {playerCount}/{maxPlayers}</p>\r\n                    <p>‚è±Ô∏è Difficulty: {room.difficulty.toUpperCase()}</p>\r\n                    <p>üé® Layout: {room.layout?.toUpperCase() || 'GRID'}</p>\r\n                  </div>\r\n                  <div className={styles.roomActions}>\r\n                    <button \r\n                      onClick={() => joinRoom(room.id, room.difficulty, room.layout || 'grid')} \r\n                      className={styles.joinBtn}\r\n                      disabled={isFull}\r\n                    >\r\n                      {isFull ? 'Full' : 'Join Room'}\r\n                    </button>\r\n                    {isHost && (\r\n                      <button \r\n                        onClick={() => deleteRoom(room.id, `Room by ${room.hostName}`)} \r\n                        className={styles.deleteBtn}\r\n                        title=\"Delete this room\"\r\n                      >\r\n                        üóëÔ∏è\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <MultiplayerLeaderboard />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MultiplayerLobby;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}