{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MARCE\\\\source\\\\repos\\\\CrazyPuzzle\\\\web\\\\src\\\\MultiplayerGame.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { realtimeDb } from './firebase';\nimport { ref, onValue, set, get, update, remove } from 'firebase/database';\nimport styles from './MultiplayerGame.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MultiplayerGame({\n  roomId,\n  user,\n  difficulty,\n  layout,\n  onLeaveRoom,\n  onBackToMenu\n}) {\n  _s();\n  var _gameState$players$us2, _gameState$players$ga;\n  const gridSizes = {\n    easy: 4,\n    medium: 6,\n    hard: 8\n  };\n  const gridSize = gridSizes[difficulty] || 4;\n  const totalTiles = gridSize * gridSize;\n\n  // Get max players based on difficulty\n  const getMaxPlayers = diff => {\n    const limits = {\n      easy: 2,\n      medium: 3,\n      hard: 4\n    };\n    return limits[diff];\n  };\n  const maxPlayers = getMaxPlayers(difficulty);\n  const [gameState, setGameState] = useState(null);\n  const [isMyTurn, setIsMyTurn] = useState(false);\n  const [timer, setTimer] = useState(0);\n\n  // Use flipped tiles from Firebase instead of local state\n  const flippedTiles = (gameState === null || gameState === void 0 ? void 0 : gameState.flippedTiles) || [];\n  useEffect(() => {\n    const roomRef = ref(realtimeDb, `rooms/${roomId}`);\n    const unsubscribe = onValue(roomRef, snapshot => {\n      if (snapshot.exists()) {\n        const data = snapshot.val();\n        setGameState(data);\n        setIsMyTurn(data.currentTurn === user.uid);\n        if (data.startTime && data.status === 'playing') {\n          const elapsed = Math.floor((Date.now() - data.startTime) / 1000);\n          setTimer(elapsed);\n        }\n\n        // If current user is no longer in players, go back to menu\n        if (data.players && !data.players[user.uid]) {\n          onLeaveRoom();\n        }\n      } else {\n        // Room was deleted, go back to menu\n        onLeaveRoom();\n      }\n    });\n    return () => unsubscribe();\n  }, [roomId, user.uid, onLeaveRoom]);\n  useEffect(() => {\n    if ((gameState === null || gameState === void 0 ? void 0 : gameState.status) === 'playing' && gameState.startTime) {\n      const interval = setInterval(() => {\n        const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);\n        setTimer(elapsed);\n      }, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [gameState === null || gameState === void 0 ? void 0 : gameState.status, gameState === null || gameState === void 0 ? void 0 : gameState.startTime]);\n  const handleReady = async () => {\n    await set(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}/ready`), true);\n\n    // Check if all players are ready to start the game\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}`));\n    if (snapshot.exists()) {\n      const room = snapshot.val();\n      const players = room.players || {};\n      const allReady = Object.values(players).every(p => p.ready);\n      if (allReady && Object.keys(players).length >= 2) {\n        startGame();\n      }\n    }\n  };\n  const startGame = async () => {\n    const safeTotal = totalTiles % 2 === 0 ? totalTiles : totalTiles - 1;\n    const pairCount = safeTotal / 2;\n    const numbers = Array.from({\n      length: pairCount\n    }, (_, i) => i + 1);\n    const shuffledTiles = [...numbers, ...numbers].sort(() => Math.random() - 0.5);\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\n    const players = snapshot.val();\n    const playerIds = Object.keys(players);\n\n    // Initialize player scores\n    const updatedPlayers = {};\n    playerIds.forEach(id => {\n      updatedPlayers[id] = {\n        ...players[id],\n        score: 0,\n        matchedTiles: []\n      };\n    });\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\n      tiles: shuffledTiles,\n      currentTurn: playerIds[0],\n      players: updatedPlayers,\n      status: 'playing',\n      startTime: Date.now(),\n      flippedTiles: []\n    });\n  };\n  const handleTileClick = async index => {\n    var _gameState$players$us;\n    if (!gameState || !isMyTurn || gameState.status !== 'playing') return;\n    if (flippedTiles.includes(index)) return;\n    const playerMatchedTiles = ((_gameState$players$us = gameState.players[user.uid]) === null || _gameState$players$us === void 0 ? void 0 : _gameState$players$us.matchedTiles) || [];\n    if (playerMatchedTiles.includes(index)) return;\n    const newFlipped = [...flippedTiles, index];\n\n    // Sync flipped tiles to Firebase so all players see them\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\n      flippedTiles: newFlipped\n    });\n    if (newFlipped.length === 2) {\n      const [first, second] = newFlipped;\n      if (gameState.tiles[first] === gameState.tiles[second]) {\n        // Match found!\n        const currentPlayer = gameState.players[user.uid];\n        const newMatchedTiles = [...(currentPlayer.matchedTiles || []), first, second];\n        const newScore = (currentPlayer.score || 0) + 10;\n        await update(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`), {\n          score: newScore,\n          matchedTiles: newMatchedTiles\n        });\n\n        // Check if game is complete\n        const allMatched = Object.values(gameState.players).reduce((sum, p) => {\n          var _p$matchedTiles;\n          return sum + (((_p$matchedTiles = p.matchedTiles) === null || _p$matchedTiles === void 0 ? void 0 : _p$matchedTiles.length) || 0);\n        }, 0) + 2 >= gameState.tiles.length;\n        if (allMatched) {\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\n            status: 'finished',\n            flippedTiles: []\n          });\n        } else {\n          // Clear flipped tiles after match\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\n            flippedTiles: []\n          });\n        }\n      } else {\n        // No match - switch turn after delay\n        setTimeout(async () => {\n          const playerIds = Object.keys(gameState.players);\n          const currentIndex = playerIds.indexOf(gameState.currentTurn);\n          const nextIndex = (currentIndex + 1) % playerIds.length;\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\n            currentTurn: playerIds[nextIndex],\n            flippedTiles: []\n          });\n        }, 1000);\n      }\n    }\n  };\n  const handleLeaveRoom = async () => {\n    await remove(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`));\n\n    // Check if any players remain\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\n    if (!snapshot.exists() || Object.keys(snapshot.val()).length === 0) {\n      // Delete room if empty\n      await remove(ref(realtimeDb, `rooms/${roomId}`));\n    }\n    onLeaveRoom();\n  };\n  const handleApprovePlayer = async playerId => {\n    var _gameState$pendingPla;\n    const pendingPlayer = gameState === null || gameState === void 0 ? void 0 : (_gameState$pendingPla = gameState.pendingPlayers) === null || _gameState$pendingPla === void 0 ? void 0 : _gameState$pendingPla[playerId];\n    if (!pendingPlayer) return;\n\n    // Move from pending to players\n    await set(ref(realtimeDb, `rooms/${roomId}/players/${playerId}`), {\n      name: pendingPlayer.name,\n      ready: true,\n      score: 0,\n      matchedTiles: []\n    });\n\n    // Remove from pending\n    await remove(ref(realtimeDb, `rooms/${roomId}/pendingPlayers/${playerId}`));\n  };\n  const handleRejectPlayer = async playerId => {\n    await remove(ref(realtimeDb, `rooms/${roomId}/pendingPlayers/${playerId}`));\n  };\n  if (!gameState || !gameState.players) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.loading,\n      children: \"Loading game...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 12\n    }, this);\n  }\n  const players = Object.entries(gameState.players || {});\n  const isReady = (_gameState$players$us2 = gameState.players[user.uid]) === null || _gameState$players$us2 === void 0 ? void 0 : _gameState$players$us2.ready;\n\n  // If current user is not in the game anymore, redirect back\n  if (!gameState.players[user.uid]) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.loading,\n      children: \"Returning to lobby...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.gameContainer,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gameHeader,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\uD83C\\uDFAE Multiplayer Game\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.gameSettings,\n          children: [difficulty.toUpperCase(), \" (\", gridSize, \"x\", gridSize, \") - \", layout.toUpperCase(), \" Layout\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.headerButtons,\n        children: [onBackToMenu && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onBackToMenu,\n          className: styles.menuBtn,\n          children: \"\\uD83C\\uDFE0 Home\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLeaveRoom,\n          className: styles.leaveBtn,\n          children: \"Leave Room\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gameInfo,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.timer,\n        children: [\"\\u23F1\\uFE0F \", Math.floor(timer / 60), \":\", (timer % 60).toString().padStart(2, '0')]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), gameState.status === 'playing' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: isMyTurn ? styles.yourTurn : styles.opponentTurn,\n        children: isMyTurn ? \"üéØ Your Turn!\" : `‚è≥ ${(_gameState$players$ga = gameState.players[gameState.currentTurn]) === null || _gameState$players$ga === void 0 ? void 0 : _gameState$players$ga.name}'s Turn`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.playersPanel,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Players\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), players.map(([id, player]) => {\n        const isCurrentUser = id === user.uid;\n        const isHost = gameState.hostId === user.uid;\n        const isWaiting = gameState.status === 'waiting';\n        const showRemoveButton = !isCurrentUser && isHost && isWaiting;\n        const showLeaveButton = !isCurrentUser && isWaiting && id === user.uid;\n        console.log(`Player ${player.name}: isCurrentUser=${isCurrentUser}, isHost=${isHost}, isWaiting=${isWaiting}, showRemoveButton=${showRemoveButton}`);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `${styles.playerCard} ${isCurrentUser ? styles.currentUser : ''} ${gameState.currentTurn === id ? styles.activeTurn : ''}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.playerInfo,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.playerName,\n              children: [player.name, \" \", isCurrentUser && '(You)', gameState.hostId === id && ' üëë']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.playerStats,\n              children: gameState.status === 'waiting' ? /*#__PURE__*/_jsxDEV(\"span\", {\n                className: player.ready ? styles.ready : styles.notReady,\n                children: player.ready ? '‚úì Ready' : '‚óã Not Ready'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                className: styles.score,\n                children: [\"Score: \", player.score || 0]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 15\n          }, this), showRemoveButton && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: async () => {\n              if (window.confirm(`Remove ${player.name} from the room?`)) {\n                await remove(ref(realtimeDb, `rooms/${roomId}/players/${id}`));\n              }\n            },\n            className: styles.removePlayerBtn,\n            title: \"Remove player\",\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 17\n          }, this), isCurrentUser && !isHost && isWaiting && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleLeaveRoom,\n            className: styles.leaveRoomBtn,\n            children: \"Leave\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 17\n          }, this)]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 7\n    }, this), gameState.status === 'waiting' && gameState.hostId === user.uid && gameState.pendingPlayers && Object.keys(gameState.pendingPlayers).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.pendingPanel,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Pending Join Requests\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 11\n      }, this), Object.entries(gameState.pendingPlayers).map(([id, pendingPlayer]) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.pendingCard,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: styles.pendingName,\n          children: pendingPlayer.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.pendingActions,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleApprovePlayer(id),\n            className: styles.approveBtn,\n            children: \"\\u2713 Accept\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleRejectPlayer(id),\n            className: styles.rejectBtn,\n            children: \"\\u2715 Reject\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 15\n        }, this)]\n      }, id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 9\n    }, this), gameState.status === 'waiting' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.waitingRoom,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Waiting for players...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Players: \", players.length, \"/\", maxPlayers]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 11\n      }, this), !isReady ? /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleReady,\n        className: styles.readyBtn,\n        children: \"I'm Ready!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: styles.readyMessage,\n        children: \"Waiting for other players to ready up...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 9\n    }, this), gameState.status === 'playing' && gameState.tiles && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.boardContainer,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${styles.puzzleGrid} ${styles[`grid${gridSize}`]}`,\n        children: gameState.tiles.map((value, index) => {\n          const allMatchedTiles = Object.values(gameState.players).flatMap(p => p.matchedTiles || []);\n          const isMatched = allMatchedTiles.includes(index);\n          const isFlipped = flippedTiles.includes(index);\n          const matchedBy = Object.entries(gameState.players).find(([_, p]) => (p.matchedTiles || []).includes(index));\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `${styles.tile} ${isFlipped || isMatched ? styles.flipped : ''} ${isMatched ? styles.matched : ''}`,\n            onClick: () => handleTileClick(index),\n            style: isMatched && matchedBy ? {\n              borderColor: getPlayerColor(matchedBy[0])\n            } : {},\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.tileFront,\n              children: \"?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.tileBack,\n              children: value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 9\n    }, this), gameState.status === 'finished' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gameOver,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\uD83C\\uDF89 Game Over!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.finalScores,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Final Scores:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 13\n        }, this), players.sort(([, a], [, b]) => (b.score || 0) - (a.score || 0)).map(([id, player], idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.finalScore,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.rank,\n            children: [idx + 1, \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.playerName,\n            children: player.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.score,\n            children: [player.score || 0, \" points\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 19\n          }, this), idx === 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.winner,\n            children: \"\\uD83D\\uDC51\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 33\n          }, this)]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 17\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLeaveRoom,\n        className: styles.playAgainBtn,\n        children: \"Back to Menu\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 246,\n    columnNumber: 5\n  }, this);\n}\n\n// Helper function to assign colors to players\n_s(MultiplayerGame, \"Px1+en9HFWQu7GHQOCXq9lS1VMg=\");\n_c = MultiplayerGame;\nfunction getPlayerColor(playerId) {\n  const colors = ['#4CAF50', '#2196F3', '#FF9800', '#E91E63'];\n  const hash = playerId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  return colors[hash % colors.length];\n}\nexport default MultiplayerGame;\nvar _c;\n$RefreshReg$(_c, \"MultiplayerGame\");","map":{"version":3,"names":["React","useState","useEffect","realtimeDb","ref","onValue","set","get","update","remove","styles","jsxDEV","_jsxDEV","MultiplayerGame","roomId","user","difficulty","layout","onLeaveRoom","onBackToMenu","_s","_gameState$players$us2","_gameState$players$ga","gridSizes","easy","medium","hard","gridSize","totalTiles","getMaxPlayers","diff","limits","maxPlayers","gameState","setGameState","isMyTurn","setIsMyTurn","timer","setTimer","flippedTiles","roomRef","unsubscribe","snapshot","exists","data","val","currentTurn","uid","startTime","status","elapsed","Math","floor","Date","now","players","interval","setInterval","clearInterval","handleReady","room","allReady","Object","values","every","p","ready","keys","length","startGame","safeTotal","pairCount","numbers","Array","from","_","i","shuffledTiles","sort","random","playerIds","updatedPlayers","forEach","id","score","matchedTiles","tiles","handleTileClick","index","_gameState$players$us","includes","playerMatchedTiles","newFlipped","first","second","currentPlayer","newMatchedTiles","newScore","allMatched","reduce","sum","_p$matchedTiles","setTimeout","currentIndex","indexOf","nextIndex","handleLeaveRoom","handleApprovePlayer","playerId","_gameState$pendingPla","pendingPlayer","pendingPlayers","name","handleRejectPlayer","className","loading","children","fileName","_jsxFileName","lineNumber","columnNumber","entries","isReady","gameContainer","gameHeader","gameSettings","toUpperCase","headerButtons","onClick","menuBtn","leaveBtn","gameInfo","toString","padStart","yourTurn","opponentTurn","playersPanel","map","player","isCurrentUser","isHost","hostId","isWaiting","showRemoveButton","showLeaveButton","console","log","playerCard","currentUser","activeTurn","playerInfo","playerName","playerStats","notReady","window","confirm","removePlayerBtn","title","leaveRoomBtn","pendingPanel","pendingCard","pendingName","pendingActions","approveBtn","rejectBtn","waitingRoom","readyBtn","readyMessage","boardContainer","puzzleGrid","value","allMatchedTiles","flatMap","isMatched","isFlipped","matchedBy","find","tile","flipped","matched","style","borderColor","getPlayerColor","tileFront","tileBack","gameOver","finalScores","a","b","idx","finalScore","rank","winner","playAgainBtn","_c","colors","hash","split","acc","char","charCodeAt","$RefreshReg$"],"sources":["C:/Users/MARCE/source/repos/CrazyPuzzle/web/src/MultiplayerGame.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { User } from 'firebase/auth';\r\nimport { realtimeDb } from './firebase';\r\nimport { ref, onValue, set, get, update, remove } from 'firebase/database';\r\nimport { Difficulty, Layout } from './DifficultySelector';\r\nimport styles from './MultiplayerGame.module.scss';\r\n\r\ninterface Player {\r\n  name: string;\r\n  ready: boolean;\r\n  score: number;\r\n  matchedTiles: number[];\r\n}\r\n\r\ninterface GameState {\r\n  hostId: string;\r\n  tiles: number[];\r\n  currentTurn: string;\r\n  players: { [key: string]: Player };\r\n  pendingPlayers?: { [key: string]: { name: string } };\r\n  status: 'waiting' | 'playing' | 'finished';\r\n  difficulty: Difficulty;\r\n  layout: Layout;\r\n  startTime?: number;\r\n  flippedTiles?: number[];\r\n}\r\n\r\ninterface MultiplayerGameProps {\r\n  roomId: string;\r\n  user: User;\r\n  difficulty: Difficulty;\r\n  layout: Layout;\r\n  onLeaveRoom: () => void;\r\n  onBackToMenu?: () => void;\r\n}\r\n\r\nfunction MultiplayerGame({ roomId, user, difficulty, layout, onLeaveRoom, onBackToMenu }: MultiplayerGameProps) {\r\n  const gridSizes: Record<Difficulty, number> = { easy: 4, medium: 6, hard: 8 };\r\n  const gridSize = gridSizes[difficulty] || 4;\r\n  const totalTiles = gridSize * gridSize;\r\n\r\n  // Get max players based on difficulty\r\n  const getMaxPlayers = (diff: Difficulty): number => {\r\n    const limits = { easy: 2, medium: 3, hard: 4 };\r\n    return limits[diff];\r\n  };\r\n  const maxPlayers = getMaxPlayers(difficulty);\r\n\r\n  const [gameState, setGameState] = useState<GameState | null>(null);\r\n  const [isMyTurn, setIsMyTurn] = useState(false);\r\n  const [timer, setTimer] = useState(0);\r\n\r\n  // Use flipped tiles from Firebase instead of local state\r\n  const flippedTiles = gameState?.flippedTiles || [];\r\n\r\n  useEffect(() => {\r\n    const roomRef = ref(realtimeDb, `rooms/${roomId}`);\r\n    \r\n    const unsubscribe = onValue(roomRef, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        setGameState(data);\r\n        setIsMyTurn(data.currentTurn === user.uid);\r\n        \r\n        if (data.startTime && data.status === 'playing') {\r\n          const elapsed = Math.floor((Date.now() - data.startTime) / 1000);\r\n          setTimer(elapsed);\r\n        }\r\n        \r\n        // If current user is no longer in players, go back to menu\r\n        if (data.players && !data.players[user.uid]) {\r\n          onLeaveRoom();\r\n        }\r\n      } else {\r\n        // Room was deleted, go back to menu\r\n        onLeaveRoom();\r\n      }\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [roomId, user.uid, onLeaveRoom]);\r\n\r\n  useEffect(() => {\r\n    if (gameState?.status === 'playing' && gameState.startTime) {\r\n      const interval = setInterval(() => {\r\n        const elapsed = Math.floor((Date.now() - gameState.startTime!) / 1000);\r\n        setTimer(elapsed);\r\n      }, 1000);\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [gameState?.status, gameState?.startTime]);\r\n\r\n  const handleReady = async () => {\r\n    await set(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}/ready`), true);\r\n    \r\n    // Check if all players are ready to start the game\r\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}`));\r\n    if (snapshot.exists()) {\r\n      const room = snapshot.val();\r\n      const players = room.players || {};\r\n      const allReady = Object.values(players).every((p: any) => p.ready);\r\n      \r\n      if (allReady && Object.keys(players).length >= 2) {\r\n        startGame();\r\n      }\r\n    }\r\n  };\r\n\r\n  const startGame = async () => {\r\n    const safeTotal = totalTiles % 2 === 0 ? totalTiles : totalTiles - 1;\r\n    const pairCount = safeTotal / 2;\r\n    const numbers = Array.from({ length: pairCount }, (_, i) => i + 1);\r\n    const shuffledTiles = [...numbers, ...numbers].sort(() => Math.random() - 0.5);\r\n\r\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\r\n    const players = snapshot.val();\r\n    const playerIds = Object.keys(players);\r\n\r\n    // Initialize player scores\r\n    const updatedPlayers: any = {};\r\n    playerIds.forEach(id => {\r\n      updatedPlayers[id] = {\r\n        ...players[id],\r\n        score: 0,\r\n        matchedTiles: []\r\n      };\r\n    });\r\n\r\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n      tiles: shuffledTiles,\r\n      currentTurn: playerIds[0],\r\n      players: updatedPlayers,\r\n      status: 'playing',\r\n      startTime: Date.now(),\r\n      flippedTiles: []\r\n    });\r\n  };\r\n\r\n  const handleTileClick = async (index: number) => {\r\n    if (!gameState || !isMyTurn || gameState.status !== 'playing') return;\r\n    if (flippedTiles.includes(index)) return;\r\n    \r\n    const playerMatchedTiles = gameState.players[user.uid]?.matchedTiles || [];\r\n    if (playerMatchedTiles.includes(index)) return;\r\n\r\n    const newFlipped = [...flippedTiles, index];\r\n    \r\n    // Sync flipped tiles to Firebase so all players see them\r\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n      flippedTiles: newFlipped\r\n    });\r\n\r\n    if (newFlipped.length === 2) {\r\n      const [first, second] = newFlipped;\r\n      \r\n      if (gameState.tiles[first] === gameState.tiles[second]) {\r\n        // Match found!\r\n        const currentPlayer = gameState.players[user.uid];\r\n        const newMatchedTiles = [...(currentPlayer.matchedTiles || []), first, second];\r\n        const newScore = (currentPlayer.score || 0) + 10;\r\n\r\n        await update(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`), {\r\n          score: newScore,\r\n          matchedTiles: newMatchedTiles\r\n        });\r\n\r\n        // Check if game is complete\r\n        const allMatched = Object.values(gameState.players).reduce(\r\n          (sum, p) => sum + (p.matchedTiles?.length || 0), \r\n          0\r\n        ) + 2 >= gameState.tiles.length;\r\n\r\n        if (allMatched) {\r\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n            status: 'finished',\r\n            flippedTiles: []\r\n          });\r\n        } else {\r\n          // Clear flipped tiles after match\r\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n            flippedTiles: []\r\n          });\r\n        }\r\n      } else {\r\n        // No match - switch turn after delay\r\n        setTimeout(async () => {\r\n          const playerIds = Object.keys(gameState.players);\r\n          const currentIndex = playerIds.indexOf(gameState.currentTurn);\r\n          const nextIndex = (currentIndex + 1) % playerIds.length;\r\n          \r\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n            currentTurn: playerIds[nextIndex],\r\n            flippedTiles: []\r\n          });\r\n        }, 1000);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleLeaveRoom = async () => {\r\n    await remove(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`));\r\n    \r\n    // Check if any players remain\r\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\r\n    if (!snapshot.exists() || Object.keys(snapshot.val()).length === 0) {\r\n      // Delete room if empty\r\n      await remove(ref(realtimeDb, `rooms/${roomId}`));\r\n    }\r\n    \r\n    onLeaveRoom();\r\n  };\r\n\r\n  const handleApprovePlayer = async (playerId: string) => {\r\n    const pendingPlayer = gameState?.pendingPlayers?.[playerId];\r\n    if (!pendingPlayer) return;\r\n\r\n    // Move from pending to players\r\n    await set(ref(realtimeDb, `rooms/${roomId}/players/${playerId}`), {\r\n      name: pendingPlayer.name,\r\n      ready: true,\r\n      score: 0,\r\n      matchedTiles: []\r\n    });\r\n\r\n    // Remove from pending\r\n    await remove(ref(realtimeDb, `rooms/${roomId}/pendingPlayers/${playerId}`));\r\n  };\r\n\r\n  const handleRejectPlayer = async (playerId: string) => {\r\n    await remove(ref(realtimeDb, `rooms/${roomId}/pendingPlayers/${playerId}`));\r\n  };\r\n\r\n  if (!gameState || !gameState.players) {\r\n    return <div className={styles.loading}>Loading game...</div>;\r\n  }\r\n\r\n  const players = Object.entries(gameState.players || {});\r\n  const isReady = gameState.players[user.uid]?.ready;\r\n\r\n  // If current user is not in the game anymore, redirect back\r\n  if (!gameState.players[user.uid]) {\r\n    return <div className={styles.loading}>Returning to lobby...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className={styles.gameContainer}>\r\n      <div className={styles.gameHeader}>\r\n        <div>\r\n          <h1>üéÆ Multiplayer Game</h1>\r\n          <p className={styles.gameSettings}>\r\n            {difficulty.toUpperCase()} ({gridSize}x{gridSize}) - {layout.toUpperCase()} Layout\r\n          </p>\r\n        </div>\r\n        <div className={styles.headerButtons}>\r\n          {onBackToMenu && (\r\n            <button onClick={onBackToMenu} className={styles.menuBtn}>\r\n              üè† Home\r\n            </button>\r\n          )}\r\n          <button onClick={handleLeaveRoom} className={styles.leaveBtn}>Leave Room</button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={styles.gameInfo}>\r\n        <div className={styles.timer}>‚è±Ô∏è {Math.floor(timer / 60)}:{(timer % 60).toString().padStart(2, '0')}</div>\r\n        {gameState.status === 'playing' && (\r\n          <div className={isMyTurn ? styles.yourTurn : styles.opponentTurn}>\r\n            {isMyTurn ? \"üéØ Your Turn!\" : `‚è≥ ${gameState.players[gameState.currentTurn]?.name}'s Turn`}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className={styles.playersPanel}>\r\n        <h3>Players</h3>\r\n        {players.map(([id, player]) => {\r\n          const isCurrentUser = id === user.uid;\r\n          const isHost = gameState.hostId === user.uid;\r\n          const isWaiting = gameState.status === 'waiting';\r\n          const showRemoveButton = !isCurrentUser && isHost && isWaiting;\r\n          const showLeaveButton = !isCurrentUser && isWaiting && id === user.uid;\r\n          \r\n          console.log(`Player ${player.name}: isCurrentUser=${isCurrentUser}, isHost=${isHost}, isWaiting=${isWaiting}, showRemoveButton=${showRemoveButton}`);\r\n          \r\n          return (\r\n            <div key={id} className={`${styles.playerCard} ${isCurrentUser ? styles.currentUser : ''} ${gameState.currentTurn === id ? styles.activeTurn : ''}`}>\r\n              <div className={styles.playerInfo}>\r\n                <div className={styles.playerName}>\r\n                  {player.name} {isCurrentUser && '(You)'}\r\n                  {gameState.hostId === id && ' üëë'}\r\n                </div>\r\n                <div className={styles.playerStats}>\r\n                  {gameState.status === 'waiting' ? (\r\n                    <span className={player.ready ? styles.ready : styles.notReady}>\r\n                      {player.ready ? '‚úì Ready' : '‚óã Not Ready'}\r\n                    </span>\r\n                  ) : (\r\n                    <span className={styles.score}>Score: {player.score || 0}</span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              {showRemoveButton && (\r\n                <button \r\n                  onClick={async () => {\r\n                    if (window.confirm(`Remove ${player.name} from the room?`)) {\r\n                      await remove(ref(realtimeDb, `rooms/${roomId}/players/${id}`));\r\n                    }\r\n                  }}\r\n                  className={styles.removePlayerBtn}\r\n                  title=\"Remove player\"\r\n                >\r\n                  ‚úï\r\n                </button>\r\n              )}\r\n              {isCurrentUser && !isHost && isWaiting && (\r\n                <button \r\n                  onClick={handleLeaveRoom}\r\n                  className={styles.leaveRoomBtn}\r\n                >\r\n                  Leave\r\n                </button>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {gameState.status === 'waiting' && gameState.hostId === user.uid && gameState.pendingPlayers && Object.keys(gameState.pendingPlayers).length > 0 && (\r\n        <div className={styles.pendingPanel}>\r\n          <h3>Pending Join Requests</h3>\r\n          {Object.entries(gameState.pendingPlayers).map(([id, pendingPlayer]) => (\r\n            <div key={id} className={styles.pendingCard}>\r\n              <span className={styles.pendingName}>{pendingPlayer.name}</span>\r\n              <div className={styles.pendingActions}>\r\n                <button \r\n                  onClick={() => handleApprovePlayer(id)}\r\n                  className={styles.approveBtn}\r\n                >\r\n                  ‚úì Accept\r\n                </button>\r\n                <button \r\n                  onClick={() => handleRejectPlayer(id)}\r\n                  className={styles.rejectBtn}\r\n                >\r\n                  ‚úï Reject\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {gameState.status === 'waiting' && (\r\n        <div className={styles.waitingRoom}>\r\n          <h2>Waiting for players...</h2>\r\n          <p>Players: {players.length}/{maxPlayers}</p>\r\n          {!isReady ? (\r\n            <button onClick={handleReady} className={styles.readyBtn}>I'm Ready!</button>\r\n          ) : (\r\n            <p className={styles.readyMessage}>Waiting for other players to ready up...</p>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {gameState.status === 'playing' && gameState.tiles && (\r\n        <div className={styles.boardContainer}>\r\n          <div \r\n            className={`${styles.puzzleGrid} ${styles[`grid${gridSize}`]}`}\r\n          >\r\n            {gameState.tiles.map((value, index) => {\r\n              const allMatchedTiles = Object.values(gameState.players).flatMap(p => p.matchedTiles || []);\r\n              const isMatched = allMatchedTiles.includes(index);\r\n              const isFlipped = flippedTiles.includes(index);\r\n              const matchedBy = Object.entries(gameState.players).find(([_, p]) => \r\n                (p.matchedTiles || []).includes(index)\r\n              );\r\n\r\n              return (\r\n                <div\r\n                  key={index}\r\n                  className={`${styles.tile} ${isFlipped || isMatched ? styles.flipped : ''} ${\r\n                    isMatched ? styles.matched : ''\r\n                  }`}\r\n                  onClick={() => handleTileClick(index)}\r\n                  style={isMatched && matchedBy ? { borderColor: getPlayerColor(matchedBy[0]) } : {}}\r\n                >\r\n                  <div className={styles.tileFront}>?</div>\r\n                  <div className={styles.tileBack}>{value}</div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {gameState.status === 'finished' && (\r\n        <div className={styles.gameOver}>\r\n          <h2>üéâ Game Over!</h2>\r\n          <div className={styles.finalScores}>\r\n            <h3>Final Scores:</h3>\r\n            {players\r\n              .sort(([, a], [, b]) => (b.score || 0) - (a.score || 0))\r\n              .map(([id, player], idx) => (\r\n                <div key={id} className={styles.finalScore}>\r\n                  <span className={styles.rank}>{idx + 1}.</span>\r\n                  <span className={styles.playerName}>{player.name}</span>\r\n                  <span className={styles.score}>{player.score || 0} points</span>\r\n                  {idx === 0 && <span className={styles.winner}>üëë</span>}\r\n                </div>\r\n              ))}\r\n          </div>\r\n          <button onClick={handleLeaveRoom} className={styles.playAgainBtn}>Back to Menu</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Helper function to assign colors to players\r\nfunction getPlayerColor(playerId: string): string {\r\n  const colors = ['#4CAF50', '#2196F3', '#FF9800', '#E91E63'];\r\n  const hash = playerId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\r\n  return colors[hash % colors.length];\r\n}\r\n\r\nexport default MultiplayerGame;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}