{"ast":null,"code":"import _objectSpread from\"C:/Users/MARCE/source/repos/CrazyPuzzle/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{db}from'./firebase';import{collection,query,where,orderBy,limit,getDocs}from'firebase/firestore';import styles from'./Leaderboard.module.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Leaderboard(_ref){let{difficulty,layout,score,timer}=_ref;const[leaderboard,setLeaderboard]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchLeaderboard=async()=>{try{setLoading(true);console.log('Fetching leaderboard for:',{difficulty,layout});const scoresRef=collection(db,'scores');const q=query(scoresRef,where('difficulty','==',difficulty),where('layout','==',layout),orderBy('score','desc'),limit(10));const querySnapshot=await getDocs(q);const scores=querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));console.log('Leaderboard fetched:',scores);setLeaderboard(scores);}catch(error){console.error('Error fetching leaderboard:',error);// Fallback: get all scores and sort client-side\ntry{const allScoresRef=collection(db,'scores');const simpleQuery=query(allScoresRef,limit(50));const snapshot=await getDocs(simpleQuery);const allScores=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data())).filter(score=>score.difficulty===difficulty&&score.layout===layout).sort((a,b)=>b.score-a.score).slice(0,10);setLeaderboard(allScores);}catch(fallbackError){console.error('Fallback query failed:',fallbackError);setLeaderboard([]);}}finally{setLoading(false);}};fetchLeaderboard();},[difficulty,layout,score,timer]);if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:styles.leaderboardCard,children:[/*#__PURE__*/_jsx(\"h3\",{className:styles.leaderboardTitle,children:\"Leaderboard\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.noScores,children:\"Loading leaderboard...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:styles.leaderboardCard,children:[/*#__PURE__*/_jsxs(\"h3\",{className:styles.leaderboardTitle,children:[\"Leaderboard - \",difficulty.charAt(0).toUpperCase()+difficulty.slice(1),\" (\",layout,\")\"]}),leaderboard.length>0?/*#__PURE__*/_jsxs(\"table\",{className:styles.leaderboardTable,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:styles.rank,children:\"Rank\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Player\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{className:styles.score,children:\"Score\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:leaderboard.map((entry,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:styles.rank,children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:entry.userName}),/*#__PURE__*/_jsxs(\"td\",{children:[entry.time,\"s\"]}),/*#__PURE__*/_jsx(\"td\",{className:styles.score,children:entry.score})]},entry.id))})]}):/*#__PURE__*/_jsx(\"div\",{className:styles.noScores,children:\"No scores yet for this difficulty and layout. Be the first to play!\"})]});}export default Leaderboard;","map":{"version":3,"names":["React","useEffect","useState","db","collection","query","where","orderBy","limit","getDocs","styles","jsx","_jsx","jsxs","_jsxs","Leaderboard","_ref","difficulty","layout","score","timer","leaderboard","setLeaderboard","loading","setLoading","fetchLeaderboard","console","log","scoresRef","q","querySnapshot","scores","docs","map","doc","_objectSpread","id","data","error","allScoresRef","simpleQuery","snapshot","allScores","filter","sort","a","b","slice","fallbackError","className","leaderboardCard","children","leaderboardTitle","noScores","charAt","toUpperCase","length","leaderboardTable","rank","entry","index","userName","time"],"sources":["C:/Users/MARCE/source/repos/CrazyPuzzle/web/src/Leaderboard.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { db } from './firebase';\r\nimport { collection, query, where, orderBy, limit, getDocs } from 'firebase/firestore';\r\nimport styles from './Leaderboard.module.scss';\r\n\r\ninterface LeaderboardProps {\r\n  difficulty: string;\r\n  layout: string;\r\n  score: number;\r\n  timer: number;\r\n}\r\n\r\ninterface Score {\r\n  id: string;\r\n  userName: string;\r\n  score: number;\r\n  time: number;\r\n  difficulty: string;\r\n  layout: string;\r\n  createdAt: any;\r\n}\r\n\r\nfunction Leaderboard({ difficulty, layout, score, timer }: LeaderboardProps) {\r\n  const [leaderboard, setLeaderboard] = useState<Score[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchLeaderboard = async () => {\r\n      try {\r\n        setLoading(true);\r\n        console.log('Fetching leaderboard for:', { difficulty, layout });\r\n        \r\n        const scoresRef = collection(db, 'scores');\r\n        const q = query(\r\n          scoresRef,\r\n          where('difficulty', '==', difficulty),\r\n          where('layout', '==', layout),\r\n          orderBy('score', 'desc'),\r\n          limit(10)\r\n        );\r\n        \r\n        const querySnapshot = await getDocs(q);\r\n        const scores = querySnapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data()\r\n        })) as Score[];\r\n        \r\n        console.log('Leaderboard fetched:', scores);\r\n        setLeaderboard(scores);\r\n      } catch (error) {\r\n        console.error('Error fetching leaderboard:', error);\r\n        // Fallback: get all scores and sort client-side\r\n        try {\r\n          const allScoresRef = collection(db, 'scores');\r\n          const simpleQuery = query(allScoresRef, limit(50));\r\n          const snapshot = await getDocs(simpleQuery);\r\n          \r\n          const allScores = snapshot.docs\r\n            .map(doc => ({ id: doc.id, ...doc.data() } as Score))\r\n            .filter(score => score.difficulty === difficulty && score.layout === layout)\r\n            .sort((a, b) => b.score - a.score)\r\n            .slice(0, 10);\r\n            \r\n          setLeaderboard(allScores);\r\n        } catch (fallbackError) {\r\n          console.error('Fallback query failed:', fallbackError);\r\n          setLeaderboard([]);\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchLeaderboard();\r\n  }, [difficulty, layout, score, timer]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className={styles.leaderboardCard}>\r\n        <h3 className={styles.leaderboardTitle}>Leaderboard</h3>\r\n        <div className={styles.noScores}>Loading leaderboard...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.leaderboardCard}>\r\n      <h3 className={styles.leaderboardTitle}>\r\n        Leaderboard - {difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} ({layout})\r\n      </h3>\r\n      \r\n      {leaderboard.length > 0 ? (\r\n        <table className={styles.leaderboardTable}>\r\n          <thead>\r\n            <tr>\r\n              <th className={styles.rank}>Rank</th>\r\n              <th>Player</th>\r\n              <th>Time</th>\r\n              <th className={styles.score}>Score</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {leaderboard.map((entry, index) => (\r\n              <tr key={entry.id}>\r\n                <td className={styles.rank}>{index + 1}</td>\r\n                <td>{entry.userName}</td>\r\n                <td>{entry.time}s</td>\r\n                <td className={styles.score}>{entry.score}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      ) : (\r\n        <div className={styles.noScores}>\r\n          No scores yet for this difficulty and layout. Be the first to play!\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Leaderboard;"],"mappings":"gIAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,EAAE,KAAQ,YAAY,CAC/B,OAASC,UAAU,CAAEC,KAAK,CAAEC,KAAK,CAAEC,OAAO,CAAEC,KAAK,CAAEC,OAAO,KAAQ,oBAAoB,CACtF,MAAO,CAAAC,MAAM,KAAM,2BAA2B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAmB/C,QAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAyD,IAAxD,CAAEC,UAAU,CAAEC,MAAM,CAAEC,KAAK,CAAEC,KAAwB,CAAC,CAAAJ,IAAA,CACzE,KAAM,CAACK,WAAW,CAAEC,cAAc,CAAC,CAAGpB,QAAQ,CAAU,EAAE,CAAC,CAC3D,KAAM,CAACqB,OAAO,CAAEC,UAAU,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAwB,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CACFD,UAAU,CAAC,IAAI,CAAC,CAChBE,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAE,CAAEV,UAAU,CAAEC,MAAO,CAAC,CAAC,CAEhE,KAAM,CAAAU,SAAS,CAAGxB,UAAU,CAACD,EAAE,CAAE,QAAQ,CAAC,CAC1C,KAAM,CAAA0B,CAAC,CAAGxB,KAAK,CACbuB,SAAS,CACTtB,KAAK,CAAC,YAAY,CAAE,IAAI,CAAEW,UAAU,CAAC,CACrCX,KAAK,CAAC,QAAQ,CAAE,IAAI,CAAEY,MAAM,CAAC,CAC7BX,OAAO,CAAC,OAAO,CAAE,MAAM,CAAC,CACxBC,KAAK,CAAC,EAAE,CACV,CAAC,CAED,KAAM,CAAAsB,aAAa,CAAG,KAAM,CAAArB,OAAO,CAACoB,CAAC,CAAC,CACtC,KAAM,CAAAE,MAAM,CAAGD,aAAa,CAACE,IAAI,CAACC,GAAG,CAACC,GAAG,EAAAC,aAAA,EACvCC,EAAE,CAAEF,GAAG,CAACE,EAAE,EACPF,GAAG,CAACG,IAAI,CAAC,CAAC,CACb,CAAY,CAEdX,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAEI,MAAM,CAAC,CAC3CT,cAAc,CAACS,MAAM,CAAC,CACxB,CAAE,MAAOO,KAAK,CAAE,CACdZ,OAAO,CAACY,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnD;AACA,GAAI,CACF,KAAM,CAAAC,YAAY,CAAGnC,UAAU,CAACD,EAAE,CAAE,QAAQ,CAAC,CAC7C,KAAM,CAAAqC,WAAW,CAAGnC,KAAK,CAACkC,YAAY,CAAE/B,KAAK,CAAC,EAAE,CAAC,CAAC,CAClD,KAAM,CAAAiC,QAAQ,CAAG,KAAM,CAAAhC,OAAO,CAAC+B,WAAW,CAAC,CAE3C,KAAM,CAAAE,SAAS,CAAGD,QAAQ,CAACT,IAAI,CAC5BC,GAAG,CAACC,GAAG,EAAAC,aAAA,EAAOC,EAAE,CAAEF,GAAG,CAACE,EAAE,EAAKF,GAAG,CAACG,IAAI,CAAC,CAAC,CAAY,CAAC,CACpDM,MAAM,CAACxB,KAAK,EAAIA,KAAK,CAACF,UAAU,GAAKA,UAAU,EAAIE,KAAK,CAACD,MAAM,GAAKA,MAAM,CAAC,CAC3E0B,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAC3B,KAAK,CAAG0B,CAAC,CAAC1B,KAAK,CAAC,CACjC4B,KAAK,CAAC,CAAC,CAAE,EAAE,CAAC,CAEfzB,cAAc,CAACoB,SAAS,CAAC,CAC3B,CAAE,MAAOM,aAAa,CAAE,CACtBtB,OAAO,CAACY,KAAK,CAAC,wBAAwB,CAAEU,aAAa,CAAC,CACtD1B,cAAc,CAAC,EAAE,CAAC,CACpB,CACF,CAAC,OAAS,CACRE,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDC,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,CAACR,UAAU,CAAEC,MAAM,CAAEC,KAAK,CAAEC,KAAK,CAAC,CAAC,CAEtC,GAAIG,OAAO,CAAE,CACX,mBACET,KAAA,QAAKmC,SAAS,CAAEvC,MAAM,CAACwC,eAAgB,CAAAC,QAAA,eACrCvC,IAAA,OAAIqC,SAAS,CAAEvC,MAAM,CAAC0C,gBAAiB,CAAAD,QAAA,CAAC,aAAW,CAAI,CAAC,cACxDvC,IAAA,QAAKqC,SAAS,CAAEvC,MAAM,CAAC2C,QAAS,CAAAF,QAAA,CAAC,wBAAsB,CAAK,CAAC,EAC1D,CAAC,CAEV,CAEA,mBACErC,KAAA,QAAKmC,SAAS,CAAEvC,MAAM,CAACwC,eAAgB,CAAAC,QAAA,eACrCrC,KAAA,OAAImC,SAAS,CAAEvC,MAAM,CAAC0C,gBAAiB,CAAAD,QAAA,EAAC,gBACxB,CAAClC,UAAU,CAACqC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAAGtC,UAAU,CAAC8B,KAAK,CAAC,CAAC,CAAC,CAAC,IAAE,CAAC7B,MAAM,CAAC,GACpF,EAAI,CAAC,CAEJG,WAAW,CAACmC,MAAM,CAAG,CAAC,cACrB1C,KAAA,UAAOmC,SAAS,CAAEvC,MAAM,CAAC+C,gBAAiB,CAAAN,QAAA,eACxCvC,IAAA,UAAAuC,QAAA,cACErC,KAAA,OAAAqC,QAAA,eACEvC,IAAA,OAAIqC,SAAS,CAAEvC,MAAM,CAACgD,IAAK,CAAAP,QAAA,CAAC,MAAI,CAAI,CAAC,cACrCvC,IAAA,OAAAuC,QAAA,CAAI,QAAM,CAAI,CAAC,cACfvC,IAAA,OAAAuC,QAAA,CAAI,MAAI,CAAI,CAAC,cACbvC,IAAA,OAAIqC,SAAS,CAAEvC,MAAM,CAACS,KAAM,CAAAgC,QAAA,CAAC,OAAK,CAAI,CAAC,EACrC,CAAC,CACA,CAAC,cACRvC,IAAA,UAAAuC,QAAA,CACG9B,WAAW,CAACY,GAAG,CAAC,CAAC0B,KAAK,CAAEC,KAAK,gBAC5B9C,KAAA,OAAAqC,QAAA,eACEvC,IAAA,OAAIqC,SAAS,CAAEvC,MAAM,CAACgD,IAAK,CAAAP,QAAA,CAAES,KAAK,CAAG,CAAC,CAAK,CAAC,cAC5ChD,IAAA,OAAAuC,QAAA,CAAKQ,KAAK,CAACE,QAAQ,CAAK,CAAC,cACzB/C,KAAA,OAAAqC,QAAA,EAAKQ,KAAK,CAACG,IAAI,CAAC,GAAC,EAAI,CAAC,cACtBlD,IAAA,OAAIqC,SAAS,CAAEvC,MAAM,CAACS,KAAM,CAAAgC,QAAA,CAAEQ,KAAK,CAACxC,KAAK,CAAK,CAAC,GAJxCwC,KAAK,CAACvB,EAKX,CACL,CAAC,CACG,CAAC,EACH,CAAC,cAERxB,IAAA,QAAKqC,SAAS,CAAEvC,MAAM,CAAC2C,QAAS,CAAAF,QAAA,CAAC,qEAEjC,CAAK,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAApC,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}