{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MARCE\\\\source\\\\repos\\\\CrazyPuzzle\\\\web\\\\src\\\\MultiplayerGame.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { realtimeDb } from './firebase';\nimport { ref, onValue, set, get, update, remove } from 'firebase/database';\nimport styles from './MultiplayerGame.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MultiplayerGame({\n  roomId,\n  user,\n  difficulty,\n  layout,\n  onLeaveRoom\n}) {\n  _s();\n  var _gameState$players$us2, _gameState$players$ga;\n  const gridSizes = {\n    easy: 4,\n    medium: 6,\n    hard: 8\n  };\n  const gridSize = gridSizes[difficulty] || 4;\n  const totalTiles = gridSize * gridSize;\n\n  // Get max players based on difficulty\n  const getMaxPlayers = diff => {\n    const limits = {\n      easy: 2,\n      medium: 3,\n      hard: 4\n    };\n    return limits[diff];\n  };\n  const maxPlayers = getMaxPlayers(difficulty);\n  const [gameState, setGameState] = useState(null);\n  const [isMyTurn, setIsMyTurn] = useState(false);\n  const [timer, setTimer] = useState(0);\n\n  // Use flipped tiles from Firebase instead of local state\n  const flippedTiles = (gameState === null || gameState === void 0 ? void 0 : gameState.flippedTiles) || [];\n  useEffect(() => {\n    const roomRef = ref(realtimeDb, `rooms/${roomId}`);\n    const unsubscribe = onValue(roomRef, snapshot => {\n      if (snapshot.exists()) {\n        const data = snapshot.val();\n        setGameState(data);\n        setIsMyTurn(data.currentTurn === user.uid);\n        if (data.startTime && data.status === 'playing') {\n          const elapsed = Math.floor((Date.now() - data.startTime) / 1000);\n          setTimer(elapsed);\n        }\n\n        // If current user is no longer in players, go back to menu\n        if (data.players && !data.players[user.uid]) {\n          onLeaveRoom();\n        }\n      } else {\n        // Room was deleted, go back to menu\n        onLeaveRoom();\n      }\n    });\n    return () => unsubscribe();\n  }, [roomId, user.uid, onLeaveRoom]);\n  useEffect(() => {\n    if ((gameState === null || gameState === void 0 ? void 0 : gameState.status) === 'playing' && gameState.startTime) {\n      const interval = setInterval(() => {\n        const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);\n        setTimer(elapsed);\n      }, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [gameState === null || gameState === void 0 ? void 0 : gameState.status, gameState === null || gameState === void 0 ? void 0 : gameState.startTime]);\n  const handleReady = async () => {\n    await set(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}/ready`), true);\n\n    // Check if all players are ready to start the game\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}`));\n    if (snapshot.exists()) {\n      const room = snapshot.val();\n      const players = room.players || {};\n      const allReady = Object.values(players).every(p => p.ready);\n      if (allReady && Object.keys(players).length >= 2) {\n        startGame();\n      }\n    }\n  };\n  const startGame = async () => {\n    const safeTotal = totalTiles % 2 === 0 ? totalTiles : totalTiles - 1;\n    const pairCount = safeTotal / 2;\n    const numbers = Array.from({\n      length: pairCount\n    }, (_, i) => i + 1);\n    const shuffledTiles = [...numbers, ...numbers].sort(() => Math.random() - 0.5);\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\n    const players = snapshot.val();\n    const playerIds = Object.keys(players);\n\n    // Initialize player scores\n    const updatedPlayers = {};\n    playerIds.forEach(id => {\n      updatedPlayers[id] = {\n        ...players[id],\n        score: 0,\n        matchedTiles: []\n      };\n    });\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\n      tiles: shuffledTiles,\n      currentTurn: playerIds[0],\n      players: updatedPlayers,\n      status: 'playing',\n      startTime: Date.now(),\n      flippedTiles: []\n    });\n  };\n  const handleTileClick = async index => {\n    var _gameState$players$us;\n    if (!gameState || !isMyTurn || gameState.status !== 'playing') return;\n    if (flippedTiles.includes(index)) return;\n    const playerMatchedTiles = ((_gameState$players$us = gameState.players[user.uid]) === null || _gameState$players$us === void 0 ? void 0 : _gameState$players$us.matchedTiles) || [];\n    if (playerMatchedTiles.includes(index)) return;\n    const newFlipped = [...flippedTiles, index];\n\n    // Sync flipped tiles to Firebase so all players see them\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\n      flippedTiles: newFlipped\n    });\n    if (newFlipped.length === 2) {\n      const [first, second] = newFlipped;\n      if (gameState.tiles[first] === gameState.tiles[second]) {\n        // Match found!\n        const currentPlayer = gameState.players[user.uid];\n        const newMatchedTiles = [...(currentPlayer.matchedTiles || []), first, second];\n        const newScore = (currentPlayer.score || 0) + 10;\n        await update(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`), {\n          score: newScore,\n          matchedTiles: newMatchedTiles\n        });\n\n        // Check if game is complete\n        const allMatched = Object.values(gameState.players).reduce((sum, p) => {\n          var _p$matchedTiles;\n          return sum + (((_p$matchedTiles = p.matchedTiles) === null || _p$matchedTiles === void 0 ? void 0 : _p$matchedTiles.length) || 0);\n        }, 0) + 2 >= gameState.tiles.length;\n        if (allMatched) {\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\n            status: 'finished',\n            flippedTiles: []\n          });\n        } else {\n          // Clear flipped tiles after match\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\n            flippedTiles: []\n          });\n        }\n      } else {\n        // No match - switch turn after delay\n        setTimeout(async () => {\n          const playerIds = Object.keys(gameState.players);\n          const currentIndex = playerIds.indexOf(gameState.currentTurn);\n          const nextIndex = (currentIndex + 1) % playerIds.length;\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\n            currentTurn: playerIds[nextIndex],\n            flippedTiles: []\n          });\n        }, 1000);\n      }\n    }\n  };\n  const handleLeaveRoom = async () => {\n    await remove(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`));\n\n    // Check if any players remain\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\n    if (!snapshot.exists() || Object.keys(snapshot.val()).length === 0) {\n      // Delete room if empty\n      await remove(ref(realtimeDb, `rooms/${roomId}`));\n    }\n    onLeaveRoom();\n  };\n  if (!gameState || !gameState.players) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.loading,\n      children: \"Loading game...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 12\n    }, this);\n  }\n  const players = Object.entries(gameState.players || {});\n  const isReady = (_gameState$players$us2 = gameState.players[user.uid]) === null || _gameState$players$us2 === void 0 ? void 0 : _gameState$players$us2.ready;\n\n  // If current user is not in the game anymore, redirect back\n  if (!gameState.players[user.uid]) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.loading,\n      children: \"Returning to lobby...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.gameContainer,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gameHeader,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\uD83C\\uDFAE Multiplayer Game\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.gameSettings,\n          children: [difficulty.toUpperCase(), \" (\", gridSize, \"x\", gridSize, \") - \", layout.toUpperCase(), \" Layout\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLeaveRoom,\n        className: styles.leaveBtn,\n        children: \"Leave Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gameInfo,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.timer,\n        children: [\"\\u23F1\\uFE0F \", Math.floor(timer / 60), \":\", (timer % 60).toString().padStart(2, '0')]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), gameState.status === 'playing' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: isMyTurn ? styles.yourTurn : styles.opponentTurn,\n        children: isMyTurn ? \"üéØ Your Turn!\" : `‚è≥ ${(_gameState$players$ga = gameState.players[gameState.currentTurn]) === null || _gameState$players$ga === void 0 ? void 0 : _gameState$players$ga.name}'s Turn`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.playersPanel,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Players\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), players.map(([id, player]) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${styles.playerCard} ${id === user.uid ? styles.currentUser : ''} ${gameState.currentTurn === id ? styles.activeTurn : ''}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.playerInfo,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.playerName,\n            children: [player.name, \" \", id === user.uid && '(You)']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.playerStats,\n            children: gameState.status === 'waiting' ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: player.ready ? styles.ready : styles.notReady,\n              children: player.ready ? '‚úì Ready' : '‚óã Not Ready'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.score,\n              children: [\"Score: \", player.score || 0]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }, this), id !== user.uid && gameState.hostId === user.uid && gameState.status === 'waiting' && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: async () => {\n            if (window.confirm(`Remove ${player.name} from the room?`)) {\n              await remove(ref(realtimeDb, `rooms/${roomId}/players/${id}`));\n            }\n          },\n          className: styles.removePlayerBtn,\n          title: \"Remove player\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 15\n        }, this)]\n      }, id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }, this), gameState.status === 'waiting' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.waitingRoom,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Waiting for players...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Players: \", players.length, \"/\", maxPlayers]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 11\n      }, this), !isReady ? /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleReady,\n        className: styles.readyBtn,\n        children: \"I'm Ready!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: styles.readyMessage,\n        children: \"Waiting for other players to ready up...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 9\n    }, this), gameState.status === 'playing' && gameState.tiles && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.boardContainer,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${styles.puzzleGrid} ${styles[`grid${gridSize}`]}`,\n        children: gameState.tiles.map((value, index) => {\n          const allMatchedTiles = Object.values(gameState.players).flatMap(p => p.matchedTiles || []);\n          const isMatched = allMatchedTiles.includes(index);\n          const isFlipped = flippedTiles.includes(index);\n          const matchedBy = Object.entries(gameState.players).find(([_, p]) => (p.matchedTiles || []).includes(index));\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `${styles.tile} ${isFlipped || isMatched ? styles.flipped : ''} ${isMatched ? styles.matched : ''}`,\n            onClick: () => handleTileClick(index),\n            style: isMatched && matchedBy ? {\n              borderColor: getPlayerColor(matchedBy[0])\n            } : {},\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.tileFront,\n              children: \"?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.tileBack,\n              children: value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 9\n    }, this), gameState.status === 'finished' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.gameOver,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\uD83C\\uDF89 Game Over!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.finalScores,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Final Scores:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 13\n        }, this), players.sort(([, a], [, b]) => (b.score || 0) - (a.score || 0)).map(([id, player], idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.finalScore,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.rank,\n            children: [idx + 1, \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.playerName,\n            children: player.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.score,\n            children: [player.score || 0, \" points\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 19\n          }, this), idx === 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: styles.winner,\n            children: \"\\uD83D\\uDC51\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 33\n          }, this)]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 17\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLeaveRoom,\n        className: styles.playAgainBtn,\n        children: \"Back to Menu\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 223,\n    columnNumber: 5\n  }, this);\n}\n\n// Helper function to assign colors to players\n_s(MultiplayerGame, \"Px1+en9HFWQu7GHQOCXq9lS1VMg=\");\n_c = MultiplayerGame;\nfunction getPlayerColor(playerId) {\n  const colors = ['#4CAF50', '#2196F3', '#FF9800', '#E91E63'];\n  const hash = playerId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  return colors[hash % colors.length];\n}\nexport default MultiplayerGame;\nvar _c;\n$RefreshReg$(_c, \"MultiplayerGame\");","map":{"version":3,"names":["React","useState","useEffect","realtimeDb","ref","onValue","set","get","update","remove","styles","jsxDEV","_jsxDEV","MultiplayerGame","roomId","user","difficulty","layout","onLeaveRoom","_s","_gameState$players$us2","_gameState$players$ga","gridSizes","easy","medium","hard","gridSize","totalTiles","getMaxPlayers","diff","limits","maxPlayers","gameState","setGameState","isMyTurn","setIsMyTurn","timer","setTimer","flippedTiles","roomRef","unsubscribe","snapshot","exists","data","val","currentTurn","uid","startTime","status","elapsed","Math","floor","Date","now","players","interval","setInterval","clearInterval","handleReady","room","allReady","Object","values","every","p","ready","keys","length","startGame","safeTotal","pairCount","numbers","Array","from","_","i","shuffledTiles","sort","random","playerIds","updatedPlayers","forEach","id","score","matchedTiles","tiles","handleTileClick","index","_gameState$players$us","includes","playerMatchedTiles","newFlipped","first","second","currentPlayer","newMatchedTiles","newScore","allMatched","reduce","sum","_p$matchedTiles","setTimeout","currentIndex","indexOf","nextIndex","handleLeaveRoom","className","loading","children","fileName","_jsxFileName","lineNumber","columnNumber","entries","isReady","gameContainer","gameHeader","gameSettings","toUpperCase","onClick","leaveBtn","gameInfo","toString","padStart","yourTurn","opponentTurn","name","playersPanel","map","player","playerCard","currentUser","activeTurn","playerInfo","playerName","playerStats","notReady","hostId","window","confirm","removePlayerBtn","title","waitingRoom","readyBtn","readyMessage","boardContainer","puzzleGrid","value","allMatchedTiles","flatMap","isMatched","isFlipped","matchedBy","find","tile","flipped","matched","style","borderColor","getPlayerColor","tileFront","tileBack","gameOver","finalScores","a","b","idx","finalScore","rank","winner","playAgainBtn","_c","playerId","colors","hash","split","acc","char","charCodeAt","$RefreshReg$"],"sources":["C:/Users/MARCE/source/repos/CrazyPuzzle/web/src/MultiplayerGame.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { User } from 'firebase/auth';\r\nimport { realtimeDb } from './firebase';\r\nimport { ref, onValue, set, get, update, remove } from 'firebase/database';\r\nimport { Difficulty, Layout } from './DifficultySelector';\r\nimport styles from './MultiplayerGame.module.scss';\r\n\r\ninterface Player {\r\n  name: string;\r\n  ready: boolean;\r\n  score: number;\r\n  matchedTiles: number[];\r\n}\r\n\r\ninterface GameState {\r\n  tiles: number[];\r\n  currentTurn: string;\r\n  players: { [key: string]: Player };\r\n  status: 'waiting' | 'playing' | 'finished';\r\n  difficulty: Difficulty;\r\n  layout: Layout;\r\n  startTime?: number;\r\n  flippedTiles?: number[];\r\n}\r\n\r\ninterface MultiplayerGameProps {\r\n  roomId: string;\r\n  user: User;\r\n  difficulty: Difficulty;\r\n  layout: Layout;\r\n  onLeaveRoom: () => void;\r\n}\r\n\r\nfunction MultiplayerGame({ roomId, user, difficulty, layout, onLeaveRoom }: MultiplayerGameProps) {\r\n  const gridSizes: Record<Difficulty, number> = { easy: 4, medium: 6, hard: 8 };\r\n  const gridSize = gridSizes[difficulty] || 4;\r\n  const totalTiles = gridSize * gridSize;\r\n\r\n  // Get max players based on difficulty\r\n  const getMaxPlayers = (diff: Difficulty): number => {\r\n    const limits = { easy: 2, medium: 3, hard: 4 };\r\n    return limits[diff];\r\n  };\r\n  const maxPlayers = getMaxPlayers(difficulty);\r\n\r\n  const [gameState, setGameState] = useState<GameState | null>(null);\r\n  const [isMyTurn, setIsMyTurn] = useState(false);\r\n  const [timer, setTimer] = useState(0);\r\n\r\n  // Use flipped tiles from Firebase instead of local state\r\n  const flippedTiles = gameState?.flippedTiles || [];\r\n\r\n  useEffect(() => {\r\n    const roomRef = ref(realtimeDb, `rooms/${roomId}`);\r\n    \r\n    const unsubscribe = onValue(roomRef, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        setGameState(data);\r\n        setIsMyTurn(data.currentTurn === user.uid);\r\n        \r\n        if (data.startTime && data.status === 'playing') {\r\n          const elapsed = Math.floor((Date.now() - data.startTime) / 1000);\r\n          setTimer(elapsed);\r\n        }\r\n        \r\n        // If current user is no longer in players, go back to menu\r\n        if (data.players && !data.players[user.uid]) {\r\n          onLeaveRoom();\r\n        }\r\n      } else {\r\n        // Room was deleted, go back to menu\r\n        onLeaveRoom();\r\n      }\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [roomId, user.uid, onLeaveRoom]);\r\n\r\n  useEffect(() => {\r\n    if (gameState?.status === 'playing' && gameState.startTime) {\r\n      const interval = setInterval(() => {\r\n        const elapsed = Math.floor((Date.now() - gameState.startTime!) / 1000);\r\n        setTimer(elapsed);\r\n      }, 1000);\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [gameState?.status, gameState?.startTime]);\r\n\r\n  const handleReady = async () => {\r\n    await set(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}/ready`), true);\r\n    \r\n    // Check if all players are ready to start the game\r\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}`));\r\n    if (snapshot.exists()) {\r\n      const room = snapshot.val();\r\n      const players = room.players || {};\r\n      const allReady = Object.values(players).every((p: any) => p.ready);\r\n      \r\n      if (allReady && Object.keys(players).length >= 2) {\r\n        startGame();\r\n      }\r\n    }\r\n  };\r\n\r\n  const startGame = async () => {\r\n    const safeTotal = totalTiles % 2 === 0 ? totalTiles : totalTiles - 1;\r\n    const pairCount = safeTotal / 2;\r\n    const numbers = Array.from({ length: pairCount }, (_, i) => i + 1);\r\n    const shuffledTiles = [...numbers, ...numbers].sort(() => Math.random() - 0.5);\r\n\r\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\r\n    const players = snapshot.val();\r\n    const playerIds = Object.keys(players);\r\n\r\n    // Initialize player scores\r\n    const updatedPlayers: any = {};\r\n    playerIds.forEach(id => {\r\n      updatedPlayers[id] = {\r\n        ...players[id],\r\n        score: 0,\r\n        matchedTiles: []\r\n      };\r\n    });\r\n\r\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n      tiles: shuffledTiles,\r\n      currentTurn: playerIds[0],\r\n      players: updatedPlayers,\r\n      status: 'playing',\r\n      startTime: Date.now(),\r\n      flippedTiles: []\r\n    });\r\n  };\r\n\r\n  const handleTileClick = async (index: number) => {\r\n    if (!gameState || !isMyTurn || gameState.status !== 'playing') return;\r\n    if (flippedTiles.includes(index)) return;\r\n    \r\n    const playerMatchedTiles = gameState.players[user.uid]?.matchedTiles || [];\r\n    if (playerMatchedTiles.includes(index)) return;\r\n\r\n    const newFlipped = [...flippedTiles, index];\r\n    \r\n    // Sync flipped tiles to Firebase so all players see them\r\n    await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n      flippedTiles: newFlipped\r\n    });\r\n\r\n    if (newFlipped.length === 2) {\r\n      const [first, second] = newFlipped;\r\n      \r\n      if (gameState.tiles[first] === gameState.tiles[second]) {\r\n        // Match found!\r\n        const currentPlayer = gameState.players[user.uid];\r\n        const newMatchedTiles = [...(currentPlayer.matchedTiles || []), first, second];\r\n        const newScore = (currentPlayer.score || 0) + 10;\r\n\r\n        await update(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`), {\r\n          score: newScore,\r\n          matchedTiles: newMatchedTiles\r\n        });\r\n\r\n        // Check if game is complete\r\n        const allMatched = Object.values(gameState.players).reduce(\r\n          (sum, p) => sum + (p.matchedTiles?.length || 0), \r\n          0\r\n        ) + 2 >= gameState.tiles.length;\r\n\r\n        if (allMatched) {\r\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n            status: 'finished',\r\n            flippedTiles: []\r\n          });\r\n        } else {\r\n          // Clear flipped tiles after match\r\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n            flippedTiles: []\r\n          });\r\n        }\r\n      } else {\r\n        // No match - switch turn after delay\r\n        setTimeout(async () => {\r\n          const playerIds = Object.keys(gameState.players);\r\n          const currentIndex = playerIds.indexOf(gameState.currentTurn);\r\n          const nextIndex = (currentIndex + 1) % playerIds.length;\r\n          \r\n          await update(ref(realtimeDb, `rooms/${roomId}`), {\r\n            currentTurn: playerIds[nextIndex],\r\n            flippedTiles: []\r\n          });\r\n        }, 1000);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleLeaveRoom = async () => {\r\n    await remove(ref(realtimeDb, `rooms/${roomId}/players/${user.uid}`));\r\n    \r\n    // Check if any players remain\r\n    const snapshot = await get(ref(realtimeDb, `rooms/${roomId}/players`));\r\n    if (!snapshot.exists() || Object.keys(snapshot.val()).length === 0) {\r\n      // Delete room if empty\r\n      await remove(ref(realtimeDb, `rooms/${roomId}`));\r\n    }\r\n    \r\n    onLeaveRoom();\r\n  };\r\n\r\n  if (!gameState || !gameState.players) {\r\n    return <div className={styles.loading}>Loading game...</div>;\r\n  }\r\n\r\n  const players = Object.entries(gameState.players || {});\r\n  const isReady = gameState.players[user.uid]?.ready;\r\n\r\n  // If current user is not in the game anymore, redirect back\r\n  if (!gameState.players[user.uid]) {\r\n    return <div className={styles.loading}>Returning to lobby...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className={styles.gameContainer}>\r\n      <div className={styles.gameHeader}>\r\n        <div>\r\n          <h1>üéÆ Multiplayer Game</h1>\r\n          <p className={styles.gameSettings}>\r\n            {difficulty.toUpperCase()} ({gridSize}x{gridSize}) - {layout.toUpperCase()} Layout\r\n          </p>\r\n        </div>\r\n        <button onClick={handleLeaveRoom} className={styles.leaveBtn}>Leave Room</button>\r\n      </div>\r\n\r\n      <div className={styles.gameInfo}>\r\n        <div className={styles.timer}>‚è±Ô∏è {Math.floor(timer / 60)}:{(timer % 60).toString().padStart(2, '0')}</div>\r\n        {gameState.status === 'playing' && (\r\n          <div className={isMyTurn ? styles.yourTurn : styles.opponentTurn}>\r\n            {isMyTurn ? \"üéØ Your Turn!\" : `‚è≥ ${gameState.players[gameState.currentTurn]?.name}'s Turn`}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className={styles.playersPanel}>\r\n        <h3>Players</h3>\r\n        {players.map(([id, player]) => (\r\n          <div key={id} className={`${styles.playerCard} ${id === user.uid ? styles.currentUser : ''} ${gameState.currentTurn === id ? styles.activeTurn : ''}`}>\r\n            <div className={styles.playerInfo}>\r\n              <div className={styles.playerName}>\r\n                {player.name} {id === user.uid && '(You)'}\r\n              </div>\r\n              <div className={styles.playerStats}>\r\n                {gameState.status === 'waiting' ? (\r\n                  <span className={player.ready ? styles.ready : styles.notReady}>\r\n                    {player.ready ? '‚úì Ready' : '‚óã Not Ready'}\r\n                  </span>\r\n                ) : (\r\n                  <span className={styles.score}>Score: {player.score || 0}</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n            {id !== user.uid && gameState.hostId === user.uid && gameState.status === 'waiting' && (\r\n              <button \r\n                onClick={async () => {\r\n                  if (window.confirm(`Remove ${player.name} from the room?`)) {\r\n                    await remove(ref(realtimeDb, `rooms/${roomId}/players/${id}`));\r\n                  }\r\n                }}\r\n                className={styles.removePlayerBtn}\r\n                title=\"Remove player\"\r\n              >\r\n                ‚úï\r\n              </button>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {gameState.status === 'waiting' && (\r\n        <div className={styles.waitingRoom}>\r\n          <h2>Waiting for players...</h2>\r\n          <p>Players: {players.length}/{maxPlayers}</p>\r\n          {!isReady ? (\r\n            <button onClick={handleReady} className={styles.readyBtn}>I'm Ready!</button>\r\n          ) : (\r\n            <p className={styles.readyMessage}>Waiting for other players to ready up...</p>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {gameState.status === 'playing' && gameState.tiles && (\r\n        <div className={styles.boardContainer}>\r\n          <div \r\n            className={`${styles.puzzleGrid} ${styles[`grid${gridSize}`]}`}\r\n          >\r\n            {gameState.tiles.map((value, index) => {\r\n              const allMatchedTiles = Object.values(gameState.players).flatMap(p => p.matchedTiles || []);\r\n              const isMatched = allMatchedTiles.includes(index);\r\n              const isFlipped = flippedTiles.includes(index);\r\n              const matchedBy = Object.entries(gameState.players).find(([_, p]) => \r\n                (p.matchedTiles || []).includes(index)\r\n              );\r\n\r\n              return (\r\n                <div\r\n                  key={index}\r\n                  className={`${styles.tile} ${isFlipped || isMatched ? styles.flipped : ''} ${\r\n                    isMatched ? styles.matched : ''\r\n                  }`}\r\n                  onClick={() => handleTileClick(index)}\r\n                  style={isMatched && matchedBy ? { borderColor: getPlayerColor(matchedBy[0]) } : {}}\r\n                >\r\n                  <div className={styles.tileFront}>?</div>\r\n                  <div className={styles.tileBack}>{value}</div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {gameState.status === 'finished' && (\r\n        <div className={styles.gameOver}>\r\n          <h2>üéâ Game Over!</h2>\r\n          <div className={styles.finalScores}>\r\n            <h3>Final Scores:</h3>\r\n            {players\r\n              .sort(([, a], [, b]) => (b.score || 0) - (a.score || 0))\r\n              .map(([id, player], idx) => (\r\n                <div key={id} className={styles.finalScore}>\r\n                  <span className={styles.rank}>{idx + 1}.</span>\r\n                  <span className={styles.playerName}>{player.name}</span>\r\n                  <span className={styles.score}>{player.score || 0} points</span>\r\n                  {idx === 0 && <span className={styles.winner}>üëë</span>}\r\n                </div>\r\n              ))}\r\n          </div>\r\n          <button onClick={handleLeaveRoom} className={styles.playAgainBtn}>Back to Menu</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Helper function to assign colors to players\r\nfunction getPlayerColor(playerId: string): string {\r\n  const colors = ['#4CAF50', '#2196F3', '#FF9800', '#E91E63'];\r\n  const hash = playerId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\r\n  return colors[hash % colors.length];\r\n}\r\n\r\nexport default MultiplayerGame;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}